rules:
  - id: p1
    pattern-either:
      - pattern: |
          for ($INIT; $COND; $UPDATE) {
            ...
            $STR = $STR + ...;
            ...
          }
      - pattern: |
          for ($INIT; $COND; $UPDATE) {
            ...
            $STR += ...;
            ...
          }
      - pattern: |
          while ($COND) {
            ...
            $STR = $STR + ...;
            ...
          }
      - pattern: |
          while ($COND) {
            ...
            $STR += ...;
            ...
          }
    message: "String concatenation detected inside a loop. Consider using StringBuilder for better performance."
    languages: [java]
    severity: WARNING