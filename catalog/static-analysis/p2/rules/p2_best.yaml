rules:
  - id: p2_best
    message: Avoid compiling a pattern inside a loop
    languages: [ java ]
    severity: WARNING
    pattern-either:
      - pattern: |
          $F(...) {
            ...
            $REGEX = "...";
            ...
            for (...) {
              ...
              $VAR = java.util.regex.Pattern.compile($REGEX);
              ...
            }
          }
      - pattern: |
          $F(...) {
            ...
            for (...) {
              ...
              $REGEX = "...";
              ...
              $VAR = java.util.regex.Pattern.compile($REGEX);
              ...
            }
          }
      - pattern: |
          $F(...) {
            ...
            $REGEX = "...";
            ...
            while (...) {
              ...
              $VAR = java.util.regex.Pattern.compile($REGEX);
              ...
            }
          }
      - pattern: |
          $F(...) {
            ...
            while (...) {
              ...
              $REGEX = "...";
              ...
              $VAR = java.util.regex.Pattern.compile($REGEX);
              ...
            }
          }
      - pattern: |
          $F(...) {
            ...
            $REGEX = "...";
            ...
            do {
              ...
              $VAR = java.util.regex.Pattern.compile($REGEX);
              ...
            } while (...)
          }
      - pattern: |
          $F(...) {
            ...
            do {
              ...
              $REGEX = "...";
              ...
              $VAR = java.util.regex.Pattern.compile($REGEX);
              ...
            } while (...)
          }
